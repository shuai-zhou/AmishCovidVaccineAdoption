------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  F:\OneDrive - The Pennsylvania State University\Academic\Publication_Sub\AmishCovid202302_Censu
> s2020Pop\results/s3.1_xtnbreg_coef.log
  log type:  text
 opened on:  15 Mar 2023, 22:50:33

. 
. *==========================================================
. * tutorials
. *==========================================================
. ** Non-negative Continuous Right-skewed Panel Data
. ** https://www.statalist.org/forums/forum/general-stata-discussion/general/1590559-non-negative-continuous
> -right-skewed-zero-inflated-panel-data-analysis
. 
. ** Negative Binomial Regression
. ** https://stats.oarc.ucla.edu/stata/dae/negative-binomial-regression/
. 
. ** Model A Continuous DV With [0, âˆž] Range
. ** https://stats.stackexchange.com/questions/142134/how-should-i-model-a-continuous-dependent-variable-in-
> the-0-infty-range
. 
. *==========================================================
. * macro IVs
. *==========================================================
. // local ivs amishpct evang_no_amish colle trump2020 hhincmed1000
. 
. local ivs amishpct evang_no_amish trump2020 hhincmed1000

. 
. // *==========================================================
. // * compile median and average hhinc in 2020
. // *==========================================================
. // infile using "$data/R13277287.dct", using("$data/R13277287_SL050.txt")
. // rename FIPS countyfips
. // rename A14006_001 hhincmed2020
. // rename A14008_001 hhincavg2020
. // gen hhincmed_1000_2020 = hhincmed2020 / 1000
. // gen hhincavg_1000_2020 = hhincavg2020 / 1000
. // keep countyfips hhinc*
. 
. // tempfile hhinc2020
. // save `hhinc2020'
. 
. *==========================================================
. * daily model: all counties
. *==========================================================
. use "$data/resdata_daily.dta", clear

. 
. xtset countynum datevar
       panel variable:  countynum (strongly balanced)
        time variable:  datevar, 01feb2021 to 26oct2022, but with gaps
                delta:  1 day

. 
. xtnbreg dr `ivs' i.b1.met, pa vce(robust)

Iteration 1: tolerance = .7460237
Iteration 2: tolerance = .39374236
Iteration 3: tolerance = .14356075
Iteration 4: tolerance = .016829
Iteration 5: tolerance = .00369313
Iteration 6: tolerance = .0001924
Iteration 7: tolerance = 1.832e-06
Iteration 8: tolerance = 1.295e-08

GEE population-averaged model                   Number of obs     =    185,640
Group variable:                  countynum      Number of groups  =        357
Link:                                  log      Obs per group:
Family:             negative binomial(k=1)                    min =        520
Correlation:                  exchangeable                    avg =      520.0
                                                              max =        520
                                                Wald chi2(5)      =     628.87
Scale parameter:                         1      Prob > chi2       =     0.0000

                                (Std. Err. adjusted for clustering on countynum)
--------------------------------------------------------------------------------
               |             Semirobust
            dr |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
      amishpct |   -.014893   .0019648    -7.58   0.000     -.018744    -.011042
evang_no_amish |   -.001168   .0006649    -1.76   0.079    -.0024712    .0001351
     trump2020 |  -.0108489   .0008283   -13.10   0.000    -.0124723   -.0092255
  hhincmed1000 |   .0031958   .0009622     3.32   0.001     .0013098    .0050817
               |
           met |
    Non-metro  |   .0141204   .0166168     0.85   0.395    -.0184479    .0466888
               |
         _cons |  -1.754257   .0889454   -19.72   0.000    -1.928587   -1.579927
--------------------------------------------------------------------------------

. collin `ivs' met
(obs=185,640)

  Collinearity Diagnostics

                        SQRT                   R-
  Variable      VIF     VIF    Tolerance    Squared
----------------------------------------------------
  amishpct      1.12    1.06    0.8890      0.1110
evang_no_amish      1.36    1.17    0.7337      0.2663
 trump2020      1.69    1.30    0.5930      0.4070
hhincmed1000      1.54    1.24    0.6488      0.3512
       met      1.33    1.15    0.7526      0.2474
----------------------------------------------------
  Mean VIF      1.41

                           Cond
        Eigenval          Index
---------------------------------
    1     4.2026          1.0000
    2     0.9006          2.1602
    3     0.6046          2.6366
    4     0.2678          3.9614
    5     0.0204         14.3463
    6     0.0040         32.5250
---------------------------------
 Condition Number        32.5250 
 Eigenvalues & Cond Index computed from scaled raw sscp (w/ intercept)
 Det(correlation matrix)    0.4044

. return list

scalars:
                 r(cn) =  32.52504543736543
              r(m_vif) =  1.408835489156021

. 
. predict drhat
(option mu assumed; Exponentiated linear prediction)

. gen resid2 = (dr - drhat) ^ 2

. gen ssr = sum(resid2)

. egen drmean = mean(dr)

. gen diff2 = (dr - drmean) ^ 2

. egen sst = sum(diff2)

. dis 1 - ssr[_N] / sst[_N]
.00329127

. 
. outreg2 using "$results/xtnbreg_coef.doc", replace stats(coef se) ///
>         label nodepvar ctitle("daily_all") ///
>         dec(3) alpha(0.001, 0.01, 0.05, 0.10) symbol(***, **, *, +)
results/xtnbreg_coef.doc
dir : seeout

. 
. *==========================================================
. * daily model: 1%
. *==========================================================
. use "$data/resdata_daily.dta", clear

. drop if amishpct < 1
(96,720 observations deleted)

. xtset countynum datevar
       panel variable:  countynum (strongly balanced)
        time variable:  datevar, 01feb2021 to 26oct2022, but with gaps
                delta:  1 day

. 
. xtnbreg dr `ivs' i.b1.met, pa vce(robust)

Iteration 1: tolerance = .7467367
Iteration 2: tolerance = .39328474
Iteration 3: tolerance = .14181212
Iteration 4: tolerance = .01370362
Iteration 5: tolerance = .00471726
Iteration 6: tolerance = .00017955
Iteration 7: tolerance = 2.125e-06
Iteration 8: tolerance = 1.183e-08

GEE population-averaged model                   Number of obs     =     88,920
Group variable:                  countynum      Number of groups  =        171
Link:                                  log      Obs per group:
Family:             negative binomial(k=1)                    min =        520
Correlation:                  exchangeable                    avg =      520.0
                                                              max =        520
                                                Wald chi2(5)      =     285.12
Scale parameter:                         1      Prob > chi2       =     0.0000

                                (Std. Err. adjusted for clustering on countynum)
--------------------------------------------------------------------------------
               |             Semirobust
            dr |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
      amishpct |  -.0153881   .0022214    -6.93   0.000    -.0197419   -.0110344
evang_no_amish |   -.000936   .0009998    -0.94   0.349    -.0028956    .0010235
     trump2020 |  -.0108568   .0012251    -8.86   0.000    -.0132578   -.0084557
  hhincmed1000 |   .0033469   .0018696     1.79   0.073    -.0003174    .0070113
               |
           met |
    Non-metro  |   -.012003   .0353021    -0.34   0.734    -.0811938    .0571878
               |
         _cons |  -1.739559    .154845   -11.23   0.000    -2.043049   -1.436068
--------------------------------------------------------------------------------

. collin `ivs' met
(obs=88,920)

  Collinearity Diagnostics

                        SQRT                   R-
  Variable      VIF     VIF    Tolerance    Squared
----------------------------------------------------
  amishpct      1.24    1.11    0.8074      0.1926
evang_no_amish      1.45    1.21    0.6884      0.3116
 trump2020      1.65    1.28    0.6074      0.3926
hhincmed1000      1.57    1.25    0.6365      0.3635
       met      1.19    1.09    0.8414      0.1586
----------------------------------------------------
  Mean VIF      1.42

                           Cond
        Eigenval          Index
---------------------------------
    1     4.2602          1.0000
    2     0.8721          2.2102
    3     0.5722          2.7287
    4     0.2758          3.9305
    5     0.0166         16.0277
    6     0.0031         37.1790
---------------------------------
 Condition Number        37.1790 
 Eigenvalues & Cond Index computed from scaled raw sscp (w/ intercept)
 Det(correlation matrix)    0.4231

. return list

scalars:
                 r(cn) =  37.1790366712959
              r(m_vif) =  1.419447614547012

. 
. predict drhat
(option mu assumed; Exponentiated linear prediction)

. gen resid2 = (dr - drhat) ^ 2

. gen ssr = sum(resid2)

. egen drmean = mean(dr)

. gen diff2 = (dr - drmean) ^ 2

. egen sst = sum(diff2)

. dis 1 - ssr[_N] / sst[_N]
.00273412

. 
. outreg2 using "$results/xtnbreg_coef.doc", append stats(coef se) ///
>         label nodepvar ctitle("daily_1%") ///
>         dec(3) alpha(0.001, 0.01, 0.05, 0.10) symbol(***, **, *, +)
results/xtnbreg_coef.doc
dir : seeout

. 
. *==========================================================
. * weekly model: all counties
. *==========================================================
. use "$data/resdata_weekly.dta", clear

. xtset countynum weekly
       panel variable:  countynum (strongly balanced)
        time variable:  weekly, 2021w5 to 2022w43
                delta:  1 week

. 
. xtnbreg wr `ivs' i.b1.met, pa vce(robust)

Iteration 1: tolerance = .76671652
Iteration 2: tolerance = .4021464
Iteration 3: tolerance = .15550232
Iteration 4: tolerance = .02336732
Iteration 5: tolerance = .00372311
Iteration 6: tolerance = .00029334
Iteration 7: tolerance = 3.500e-06
Iteration 8: tolerance = 1.616e-08

GEE population-averaged model                   Number of obs     =     32,487
Group variable:                  countynum      Number of groups  =        357
Link:                                  log      Obs per group:
Family:             negative binomial(k=1)                    min =         91
Correlation:                  exchangeable                    avg =       91.0
                                                              max =         91
                                                Wald chi2(5)      =     538.62
Scale parameter:                         1      Prob > chi2       =     0.0000

                                (Std. Err. adjusted for clustering on countynum)
--------------------------------------------------------------------------------
               |             Semirobust
            wr |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
      amishpct |  -.0151954   .0021315    -7.13   0.000    -.0193731   -.0110177
evang_no_amish |  -.0007878   .0006846    -1.15   0.250    -.0021296     .000554
     trump2020 |  -.0109567   .0008658   -12.65   0.000    -.0126537   -.0092598
  hhincmed1000 |   .0036002   .0011168     3.22   0.001     .0014113     .005789
               |
           met |
    Non-metro  |   -.000765   .0187401    -0.04   0.967     -.037495    .0359649
               |
         _cons |   -1.86301   .0972186   -19.16   0.000    -2.053555   -1.672465
--------------------------------------------------------------------------------

. collin `ivs' met
(obs=32,487)

  Collinearity Diagnostics

                        SQRT                   R-
  Variable      VIF     VIF    Tolerance    Squared
----------------------------------------------------
  amishpct      1.12    1.06    0.8890      0.1110
evang_no_amish      1.36    1.17    0.7337      0.2663
 trump2020      1.69    1.30    0.5930      0.4070
hhincmed1000      1.54    1.24    0.6488      0.3512
       met      1.33    1.15    0.7526      0.2474
----------------------------------------------------
  Mean VIF      1.41

                           Cond
        Eigenval          Index
---------------------------------
    1     4.2026          1.0000
    2     0.9006          2.1602
    3     0.6046          2.6366
    4     0.2678          3.9614
    5     0.0204         14.3463
    6     0.0040         32.5250
---------------------------------
 Condition Number        32.5250 
 Eigenvalues & Cond Index computed from scaled raw sscp (w/ intercept)
 Det(correlation matrix)    0.4044

. return list

scalars:
                 r(cn) =  32.52504543742544
              r(m_vif) =  1.408835489156536

. 
. predict wrhat
(option mu assumed; Exponentiated linear prediction)

. gen resid2 = (wr - wrhat) ^ 2

. gen ssr = sum(resid2)

. egen wrmean = mean(wr)

. gen diff2 = (wr - wrmean) ^ 2

. egen sst = sum(diff2)

. dis 1 - ssr[_N] / sst[_N]
.01054507

. 
. outreg2 using "$results/xtnbreg_coef.doc", append stats(coef se) ///
>         label nodepvar ctitle("weekly_all") ///
>         dec(3) alpha(0.001, 0.01, 0.05, 0.10) symbol(***, **, *, +)
results/xtnbreg_coef.doc
dir : seeout

. 
. *==========================================================
. * weekly model: 1%
. *==========================================================
. use "$data/resdata_weekly.dta", clear

. drop if amishpct < 1
(16,926 observations deleted)

. xtset countynum weekly
       panel variable:  countynum (strongly balanced)
        time variable:  weekly, 2021w5 to 2022w43
                delta:  1 week

. 
. xtnbreg wr `ivs' i.b1.met, pa vce(robust)

Iteration 1: tolerance = .76492209
Iteration 2: tolerance = .40058083
Iteration 3: tolerance = .15185445
Iteration 4: tolerance = .0182246
Iteration 5: tolerance = .00552596
Iteration 6: tolerance = .00026968
Iteration 7: tolerance = 2.681e-06
Iteration 8: tolerance = 1.559e-08

GEE population-averaged model                   Number of obs     =     15,561
Group variable:                  countynum      Number of groups  =        171
Link:                                  log      Obs per group:
Family:             negative binomial(k=1)                    min =         91
Correlation:                  exchangeable                    avg =       91.0
                                                              max =         91
                                                Wald chi2(5)      =     236.87
Scale parameter:                         1      Prob > chi2       =     0.0000

                                (Std. Err. adjusted for clustering on countynum)
--------------------------------------------------------------------------------
               |             Semirobust
            wr |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
      amishpct |  -.0159484   .0023752    -6.71   0.000    -.0206038   -.0112931
evang_no_amish |  -.0006448   .0010173    -0.63   0.526    -.0026388    .0013491
     trump2020 |   -.010831   .0013015    -8.32   0.000     -.013382   -.0082801
  hhincmed1000 |   .0032503   .0019567     1.66   0.097    -.0005847    .0070853
               |
           met |
    Non-metro  |  -.0264242   .0404485    -0.65   0.514    -.1057019    .0528535
               |
         _cons |  -1.827634   .1652272   -11.06   0.000    -2.151474   -1.503795
--------------------------------------------------------------------------------

. collin `ivs' met
(obs=15,561)

  Collinearity Diagnostics

                        SQRT                   R-
  Variable      VIF     VIF    Tolerance    Squared
----------------------------------------------------
  amishpct      1.24    1.11    0.8074      0.1926
evang_no_amish      1.45    1.21    0.6884      0.3116
 trump2020      1.65    1.28    0.6074      0.3926
hhincmed1000      1.57    1.25    0.6365      0.3635
       met      1.19    1.09    0.8414      0.1586
----------------------------------------------------
  Mean VIF      1.42

                           Cond
        Eigenval          Index
---------------------------------
    1     4.2602          1.0000
    2     0.8721          2.2102
    3     0.5722          2.7287
    4     0.2758          3.9305
    5     0.0166         16.0277
    6     0.0031         37.1790
---------------------------------
 Condition Number        37.1790 
 Eigenvalues & Cond Index computed from scaled raw sscp (w/ intercept)
 Det(correlation matrix)    0.4231

. return list

scalars:
                 r(cn) =  37.17903667142018
              r(m_vif) =  1.419447614546995

. 
. predict wrhat
(option mu assumed; Exponentiated linear prediction)

. gen resid2 = (wr - wrhat) ^ 2

. gen ssr = sum(resid2)

. egen wrmean = mean(wr)

. gen diff2 = (wr - wrmean) ^ 2

. egen sst = sum(diff2)

. dis 1 - ssr[_N] / sst[_N]
.00837187

. 
. outreg2 using "$results/xtnbreg_coef.doc", append stats(coef se) ///
>         label nodepvar ctitle("weekly_1%") ///
>         dec(3) alpha(0.001, 0.01, 0.05, 0.10) symbol(***, **, *, +)
results/xtnbreg_coef.doc
dir : seeout

. 
. *==========================================================
. * monthly model: all counties
. *==========================================================
. use "$data/resdata_monthly.dta", clear

. xtset countynum monthly
       panel variable:  countynum (strongly balanced)
        time variable:  monthly, 2021m2 to 2022m10
                delta:  1 month

. 
. xtnbreg mr `ivs' i.b1.met, pa vce(robust)

Iteration 1: tolerance = .76886159
Iteration 2: tolerance = .40310706
Iteration 3: tolerance = .15701437
Iteration 4: tolerance = .02455607
Iteration 5: tolerance = .00347226
Iteration 6: tolerance = .00028722
Iteration 7: tolerance = 3.415e-06
Iteration 8: tolerance = 1.522e-08

GEE population-averaged model                   Number of obs     =      7,497
Group variable:                  countynum      Number of groups  =        357
Link:                                  log      Obs per group:
Family:             negative binomial(k=1)                    min =         21
Correlation:                  exchangeable                    avg =       21.0
                                                              max =         21
                                                Wald chi2(5)      =     552.80
Scale parameter:                         1      Prob > chi2       =     0.0000

                                (Std. Err. adjusted for clustering on countynum)
--------------------------------------------------------------------------------
               |             Semirobust
            mr |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
      amishpct |   -.015252   .0021149    -7.21   0.000    -.0193971   -.0111068
evang_no_amish |   -.000813   .0006639    -1.22   0.221    -.0021142    .0004883
     trump2020 |  -.0109268   .0008596   -12.71   0.000    -.0126116   -.0092419
  hhincmed1000 |   .0037135   .0011085     3.35   0.001     .0015408    .0058861
               |
           met |
    Non-metro  |   .0023709   .0182322     0.13   0.897    -.0333636    .0381054
               |
         _cons |  -1.877446    .096224   -19.51   0.000    -2.066042    -1.68885
--------------------------------------------------------------------------------

. collin `ivs' met
(obs=7,497)

  Collinearity Diagnostics

                        SQRT                   R-
  Variable      VIF     VIF    Tolerance    Squared
----------------------------------------------------
  amishpct      1.12    1.06    0.8890      0.1110
evang_no_amish      1.36    1.17    0.7337      0.2663
 trump2020      1.69    1.30    0.5930      0.4070
hhincmed1000      1.54    1.24    0.6488      0.3512
       met      1.33    1.15    0.7526      0.2474
----------------------------------------------------
  Mean VIF      1.41

                           Cond
        Eigenval          Index
---------------------------------
    1     4.2026          1.0000
    2     0.9006          2.1602
    3     0.6046          2.6366
    4     0.2678          3.9614
    5     0.0204         14.3463
    6     0.0040         32.5250
---------------------------------
 Condition Number        32.5250 
 Eigenvalues & Cond Index computed from scaled raw sscp (w/ intercept)
 Det(correlation matrix)    0.4044

. return list

scalars:
                 r(cn) =  32.52504543743341
              r(m_vif) =  1.408835489156514

. 
. predict mrhat
(option mu assumed; Exponentiated linear prediction)

. gen resid2 = (mr - mrhat) ^ 2

. gen ssr = sum(resid2)

. egen mrmean = mean(mr)

. gen diff2 = (mr - mrmean) ^ 2

. egen sst = sum(diff2)

. dis 1 - ssr[_N] / sst[_N]
.01550445

. 
. outreg2 using "$results/xtnbreg_coef.doc", append stats(coef se) ///
>         label nodepvar ctitle("monthly_all") ///
>         dec(3) alpha(0.001, 0.01, 0.05, 0.10) symbol(***, **, *, +)
results/xtnbreg_coef.doc
dir : seeout

. 
. *==========================================================
. * monthly model: 1%
. *==========================================================
. use "$data/resdata_monthly.dta", clear

. drop if amishpct < 1
(3,906 observations deleted)

. xtset countynum monthly
       panel variable:  countynum (strongly balanced)
        time variable:  monthly, 2021m2 to 2022m10
                delta:  1 month

. 
. xtnbreg mr `ivs' i.b1.met, pa vce(robust)

Iteration 1: tolerance = .76689167
Iteration 2: tolerance = .40149338
Iteration 3: tolerance = .15332449
Iteration 4: tolerance = .01945678
Iteration 5: tolerance = .00522535
Iteration 6: tolerance = .00025744
Iteration 7: tolerance = 2.421e-06
Iteration 8: tolerance = 1.402e-08

GEE population-averaged model                   Number of obs     =      3,591
Group variable:                  countynum      Number of groups  =        171
Link:                                  log      Obs per group:
Family:             negative binomial(k=1)                    min =         21
Correlation:                  exchangeable                    avg =       21.0
                                                              max =         21
                                                Wald chi2(5)      =     245.56
Scale parameter:                         1      Prob > chi2       =     0.0000

                                (Std. Err. adjusted for clustering on countynum)
--------------------------------------------------------------------------------
               |             Semirobust
            mr |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
      amishpct |  -.0160269   .0023531    -6.81   0.000    -.0206388   -.0114149
evang_no_amish |  -.0006263   .0010049    -0.62   0.533    -.0025959    .0013433
     trump2020 |  -.0108011   .0012924    -8.36   0.000    -.0133341    -.008268
  hhincmed1000 |   .0033443   .0019543     1.71   0.087    -.0004859    .0071746
               |
           met |
    Non-metro  |  -.0230953   .0394768    -0.59   0.559    -.1004684    .0542778
               |
         _cons |  -1.841639   .1638002   -11.24   0.000    -2.162682   -1.520597
--------------------------------------------------------------------------------

. collin `ivs' met
(obs=3,591)

  Collinearity Diagnostics

                        SQRT                   R-
  Variable      VIF     VIF    Tolerance    Squared
----------------------------------------------------
  amishpct      1.24    1.11    0.8074      0.1926
evang_no_amish      1.45    1.21    0.6884      0.3116
 trump2020      1.65    1.28    0.6074      0.3926
hhincmed1000      1.57    1.25    0.6365      0.3635
       met      1.19    1.09    0.8414      0.1586
----------------------------------------------------
  Mean VIF      1.42

                           Cond
        Eigenval          Index
---------------------------------
    1     4.2602          1.0000
    2     0.8721          2.2102
    3     0.5722          2.7287
    4     0.2758          3.9305
    5     0.0166         16.0277
    6     0.0031         37.1790
---------------------------------
 Condition Number        37.1790 
 Eigenvalues & Cond Index computed from scaled raw sscp (w/ intercept)
 Det(correlation matrix)    0.4231

. return list

scalars:
                 r(cn) =  37.17903667134032
              r(m_vif) =  1.419447614546997

. 
. predict mrhat
(option mu assumed; Exponentiated linear prediction)

. gen resid2 = (mr - mrhat) ^ 2

. gen ssr = sum(resid2)

. egen mrmean = mean(mr)

. gen diff2 = (mr - mrmean) ^ 2

. egen sst = sum(diff2)

. dis 1 - ssr[_N] / sst[_N]
.01268853

. 
. outreg2 using "$results/xtnbreg_coef.doc", append stats(coef se) ///
>         label nodepvar ctitle("monthly_1%") ///
>         dec(3) alpha(0.001, 0.01, 0.05, 0.10) symbol(***, **, *, +)
results/xtnbreg_coef.doc
dir : seeout

. 
. *==========================================================
. * end logging
. *==========================================================
. clear

. log close _all
      name:  <unnamed>
       log:  F:\OneDrive - The Pennsylvania State University\Academic\Publication_Sub\AmishCovid202302_Censu
> s2020Pop\results/s3.1_xtnbreg_coef.log
  log type:  text
 closed on:  15 Mar 2023, 22:51:29
------------------------------------------------------------------------------------------------------------
